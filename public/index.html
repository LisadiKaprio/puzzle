<html>
<head>
  <link rel="stylesheet" href="/style.css" />
  <script src="https://unpkg.com/vue@3.0.11"></script>
  <script src="https://unpkg.com/vue-router@4.0.8"></script>
  <title>ðŸ§© jigsaw.hyottoko.club</title>
</head>
<body>
  <div id="app"></div>
  <script type="module">
  import App from "/App.vue.js"
  import Index from "/views/Index.vue.js"
  import NewGame from "/views/NewGame.vue.js"
  import Game from "/views/Game.vue.js"
  import Replay from "/views/Replay.vue.js"

  (async () => {
    const res = await fetch(`/api/conf`)
    const conf = await res.json()

    const router = VueRouter.createRouter({
      history: VueRouter.createWebHashHistory(),
      routes: [
        { name: 'index', path: '/', component: Index },
        { name: 'new-game', path: '/new-game', component: NewGame },
        { name: 'game', path: '/g/:id', component: Game },
        { name: 'replay', path: '/replay/:id', component: Replay },
      ],
    })

    router.beforeEach((to, from) => {
      if (from.name !== undefined) {
        document.documentElement.classList.remove(`view-${from.name}`)
      }
      document.documentElement.classList.add(`view-${to.name}`)
    })

    const app = Vue.createApp(App)
    app.config.globalProperties.$config = conf
    app.use(router)
    app.mount('#app')
  })()
  </script>
</body>
</html>
